#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo 'ğŸ—ï¸ Styling, testing and building your project before committing'
cd packages/frontend/

# Check Prettier standards
npm run format && npm run check-format ||
(
   echo 'âŒâŒâŒ  Your formatting is raw âŒâŒâŒ
   Run "npm run format" script.
   Prettier Check Failed. Run npm run format, add changes and try commit again.';
   false;
)

# Check ESLint Standards
npm run lint &&npm run check-lint ||
(
   echo 'âŒâŒâŒ Your code style is incoherent âŒâŒâŒ 
   Run "npm run lint" script.
   ESLint Check Failed. Run npm lint and make the required changes listed above, add changes and try to commit again.'
   false; 
)

# Check tsconfig standards
npm run check-types ||
(
   echo 'âŒâŒâŒ Failed Type check. âŒâŒâŒ
   Make the changes required above.'
   false;
)

# If everything passes... Now we can commit
echo 'âš™ï¸âš™ï¸âš™ï¸ Code looks good. Trying to build now... âš™ï¸âš™ï¸âš™ï¸'

npm run build ||
(
   echo 'âŒâŒâŒ Your build failed âŒâŒâŒ.
   Run "npm run build" script.
   React build failed: View the errors above to see why. '
   false;
)

# If everything passes... Now we can commit
echo 'âœ…âœ…âœ… All scripts succedded. Committing this now. âœ…âœ…âœ…'